<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChuckHill2.Utilities: Yet Another Logging API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxygen_Extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ProjectLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChuckHill2.Utilities
   &#160;<span id="projectnumber">1.0.1.0</span>
   </div>
   <div id="projectbrief">C# WinForms Utility Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Yet Another Logging API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A thin wrapper around System.Diagnostics.Trace that extends its functionality and minimizes the usage learning curve.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Purpose</h2>
<p>Write logging events to an output destination for purposes of support AFTER the product has been released to customers.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
What is logging?</h2>
<p>In a clear way, logging is just a fancy word to define a process of writing down everything an application does.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Terminology</h2>
<ul>
<li><b>Log Event</b> - The message to be sent to one or more listeners. It contains a user-message plus other event properties.</li>
<li><b>Severity Level</b> - Log events are partitioned by how bad (aka severe) the action is.</li>
<li><b>Listener</b> - A listener is an output destination for the log event.</li>
<li><b>Event/Trace Source</b> - The identifier for a code module or service.</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
Severity Levels</h2>
<ul>
<li><b>Critical</b> - The action failed badly and the application/service will be terminated.</li>
<li><b>Error</b> - The action failed and the operation will not continue.</li>
<li><b>Warning</b> - The action failed but recovered and will continue.</li>
<li><b>Information</b> - The action status. Should be used for high level actions only.</li>
<li><b>Verbose</b> - Detailed action status. For low-level action details. Should be enabled for debugging only as it will be a performance hit.</li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
SourceLevels vs TraceLevel vs TraceEventType enums</h3>
<ul>
<li>SourceLevels - The bit-wise filter of logging events that are allowed to be written where:<ul>
<li>Off - Writing to this source is disabled.</li>
<li>Critical - Only critical events are written. All others are thrown out.</li>
<li>Error - Only critical and error events are written.</li>
<li>Warning - Critical, error, and warning events are written.</li>
<li>Information - Critical, error, warning, and information events are written.</li>
<li>Verbose - Critical, error, warning, information, and verbose events are written.</li>
<li>ActivityTracing - Only (Start,Stop,Suspend,Resume,Transfer) events are written.</li>
<li>All - All event messages are written. (same as Verbose|ActivityTracing)</li>
</ul>
</li>
<li>TraceEventType - The severity of specific event that is being logged.</li>
<li>TraceLevel - Legacy. Subset of SourceLevels (Off,Error,Warning,Info,Verbose)</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Features</h2>
<ul>
<li>Thin wrapper around built-in .NET System.Diagnostics Trace and TraceSource logging. This allows transparent use of ALL pre-existing Trace and TraceSource API <em>including</em> what is already built-in to WPF,WCF, System.Net, etc.</li>
<li>No changes or extensions to the App/Web config configuration.</li>
<li>Simple logging API that avoid any message processing/formatting unless message is actually going to be written.</li>
<li>Efficient TraceSource allocation. Unlike the TraceSource constructor which always creates a new trace source, this logging constructor reuses pre-existing open trace sources.</li>
<li>Redirect all Trace/Debug messages that do not contain a trace source name (some do!) to the built-in <b>TRACE</b> trace source.</li>
<li>Optionally duplicate all Console.WriteXXX() messages to the built-in <b>CONSOLE</b> trace source. Useful when there is no console window.</li>
<li>Optionally capture all first-chance exceptions (cannot be hidden by try/catch/swallow blocks) and write to the built-in <b>FIRSTCHANCE</b> trace source. Exceptions cannot hide.</li>
<li>Detects changes to the &lt;system.diagnostics&gt; section of the application or web config. Changes to other parts of the config are ignored. Useful for changing the logging severity without rebooting the application.</li>
<li>Optionally capture and copy all logging events and post asynchronously to subscribed C# event handlers. Maybe show logging in a live UI status window?</li>
<li>Programmatically set/reset trace source severity as needed.</li>
<li>Upon exit, queued messages are flushed before exit. None are lost.</li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
Built-in Trace Sources</h3>
<p>The following create copies of the messages before they are routed to their normal destinations. By default, these trace sources are disabled (e.g. SeverityLevel.Off)</p><ul>
<li><b>TRACE</b> - Captures all System.Diagnostics.Debug and System.Diagnostics.Trace messages.</li>
<li><b>CONSOLE</b> - Captures all System.Console messages even if there is no console attached to the application.</li>
<li><b>FIRSTCHANCE</b> - Captures exceptions before they are passed to the application code. This cannot be blocked by try/catch blocks.</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
App.config Editor</h2>
<p>LoggerEditor.exe is an editing application provided to add and configure all the System.Diagnostics logging properties. This application includes all the logic, constraints, and help to simplify the editing process. It does not touch the other App.config nodes. It also maintains any user comments that may exist among the System.Diagnostics logging properties.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Logging Listeners / Appenders (NLog name!)</h2>
<h3><a class="anchor" id="autotoc_md12"></a>
.NET System.Diagnostics Listeners</h3>
<p>These listeners are provided as a part of .NET. However, all writing is synchronous.</p><ul>
<li>System.Diagnostics.TextWriterTraceListener</li>
<li>System.Diagnostics.ConsoleTraceListener</li>
<li>System.Diagnostics.DefaultTraceListener</li>
<li>System.Diagnostics.DelimitedListTraceListener</li>
<li>System.Diagnostics.XmlWriterTraceListener</li>
<li>System.Diagnostics.EventLogTraceListener</li>
<li>System.Diagnostics.EventSchemaTraceListener</li>
<li>System.Diagnostics.Eventing.EventProviderTraceListener</li>
<li>System.Web.IisTraceListener</li>
<li>System.Web.WebPageTraceListener</li>
</ul>
<p>These listeners may be used but the following listeners are much better.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
.NET ChuckHill2.Logging Listeners</h3>
<p>These logging features are available to all the following listeners.</p><ul>
<li>Optionally lazily write messages to their output destinations in a low-priority worker thread.</li>
<li>Optionally handle custom message formatting with many more parameters than that provided by System.Diagnostics.</li>
<li>Handle redirection of Trace/Debug messages that do not contain a trace source (some do!) to the built-in TRACE source.</li>
<li>Safely cleanup upon close/dispose. Asynchronous messages are completely flushed before application exit.</li>
<li>Efficiently re-use pre-existing trace sources. System.Diagnostics does not!</li>
<li>Thread-safe and cross-process safe.</li>
<li>Initialized only upon first log message/event.</li>
<li>Custom event message formatting.</li>
</ul>
<h4><a class="anchor" id="autotoc_md14"></a>
EventLogTraceListener</h4>
<p>All of all the basic logging listener features, plus…</p><ul>
<li>Optionally creates the event log and event source if they do not exist.</li>
</ul>
<h4><a class="anchor" id="autotoc_md15"></a>
FileTraceListener</h4>
<p>All of all the basic logging listener features, plus…</p><ul>
<li>Output file name may include any environment variables plus some special pre-defined environment variables</li>
<li>File will create a new file (aka 'roll over') after a max file size has been set, default=100MB</li>
<li>Rollover file count exceeding a maximum limit will be deleted, oldest first. Default=0 (e.g. never deleted).</li>
<li>Files may optionally have a header and/or footer. Important for XML-like files. Nice for CSV.</li>
<li>Same file may be safely written to by multiple threads and multiple processes, simultaneously.</li>
<li>CSV-like format strings (e.g. "{DateTime:G},{Severity},{Message}") will be reformatted and results written out as formal CSV readable by Excel, including multi-line fields.</li>
</ul>
<h4><a class="anchor" id="autotoc_md16"></a>
DebugTraceListener</h4>
<p>Just the basic logging listener features. There are no additional properties.</p>
<h4><a class="anchor" id="autotoc_md17"></a>
EmailTraceListener</h4>
<p>All of all the basic logging listener features, plus…</p>
<ul>
<li>Set the source email address.</li>
<li>Set the destination email address(es).</li>
<li>Optionally override the &lt;system.net&gt;&lt;mailsettings&gt; properties.</li>
</ul>
<h4><a class="anchor" id="autotoc_md18"></a>
DatabaseTraceListener</h4>
<p>Just the basic logging listener features.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Listener Filters</h3>
<p>In addition, a listener may have 0 or more filter child nodes. A filter allows or disallows a trace message to be written based upon the properties of the trace message.</p>
<h4><a class="anchor" id="autotoc_md20"></a>
ChuckHill2.MultiSourceFilter</h4>
<p>'initializeData' attribute contains a comma-delimited list of source names that are not allowed to write to this listener. The source names may or may not be in the list of known sources as new sources may be created on the fly.</p>
<h4><a class="anchor" id="autotoc_md21"></a>
System.Diagnostics.SourceFilter</h4>
<p>'initializeData' attribute contains the name of a single source. This source is the only one allowed to write to this listener. The source name may or may not be in the list of known sources as new sources may be created on the fly.</p>
<h4><a class="anchor" id="autotoc_md22"></a>
System.Diagnostics.EventTypeFilter</h4>
<p>'initializeData' attribute contains the single source level (from enum SourceLevels). Only TraceEvents at least as severe than this source level is allowed to be written to this listener.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Performance Test</h2>
<p>The LoggerDemo app tests different features of the logger. In particular, the performance test writes all messages to a single file. 3 threads each writing 100,000 messages * 3 processes (900,000 messages total) asynchronously took 6 seconds to complete. It took an additional 4 seconds to for all three processes to flush their message queues upon exit. This result is ideal, as more resource-intensive properties (like retrieving the callstack) and/or more resource-intensive logging will cause the duration to increase. Your mileage may vary.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
Example App.Config</h2>
<p>The following example shows, with comments, all the possible permutations of the system.diagnostics section of the app/web.config.</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">configuration</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">connectionStrings</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ActiveDirectory&quot;</span> <span class="keyword">connectionString</span>=<span class="stringliteral">&quot;LDAP://127.0.0.1&quot;</span> <span class="keyword">providerName</span>=<span class="stringliteral">&quot;&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MySecurity&quot;</span> <span class="keyword">connectionString</span>=<span class="stringliteral">&quot;Data Source=(local);Initial Catalog=MySecurity;Integrated Security=SSPI&quot;</span> <span class="keyword">providerName</span>=<span class="stringliteral">&quot;System.Data.SqlClient&quot;</span>/&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">connectionStrings</span>&gt;</div>
<div class="line">  </div>
<div class="line">  &lt;<span class="keywordtype">system.diagnostics</span>&gt;</div>
<div class="line">    <span class="comment">&lt;!--default list of listeners for new sources not listed below--&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">trace</span> <span class="keyword">autoflush</span>=<span class="stringliteral">&quot;false&quot;</span> <span class="keyword">indentsize</span>=<span class="stringliteral">&quot;4&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span>/&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DebugListener&quot;</span>/&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">trace</span>&gt;</div>
<div class="line">    </div>
<div class="line">    &lt;<span class="keywordtype">switches</span>&gt;</div>
<div class="line">      <span class="comment">&lt;!-- Switch value choices: Off Error Warning Info Verbose --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Group1&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;Warning&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">switches</span>&gt;</div>
<div class="line">    </div>
<div class="line">    &lt;<span class="keywordtype">sources</span>&gt;</div>
<div class="line">      <span class="comment">&lt;!-- switchValue Choices: Off Critical Error Warning Information Verbose All --&gt;</span></div>
<div class="line">      <span class="comment">&lt;!-- Built-in TRACE, CONSOLE, and FIRSTCHANCE are either All (e.g. on) or Off --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;TRACE&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;All&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DebugListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;CONSOLE&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;All&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DebugListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FIRSTCHANCE&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;All&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FormattedFileListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;General&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;Error&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;CsvFileListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MySource&quot;</span> <span class="keyword">switchName</span>=<span class="stringliteral">&quot;Group1&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FormattedFileListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MyEvSource&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;Information&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span> /&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;EventLogListener&quot;</span> /&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">source</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;SystemStatus&quot;</span> <span class="keyword">switchValue</span>=<span class="stringliteral">&quot;Off&quot;</span> <span class="keyword">switchType</span>=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;<span class="keywordtype">listeners</span>&gt;&lt;<span class="keywordtype">clear</span>/&gt;&lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;EmailListener&quot;</span>/&gt;&lt;/<span class="keywordtype">listeners</span>&gt;&lt;/<span class="keywordtype">source</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">sources</span>&gt;</div>
<div class="line">    </div>
<div class="line">    &lt;<span class="keywordtype">sharedListeners</span>&gt;</div>
<div class="line">      <span class="comment">&lt;!-- Listener common properties -</span></div>
<div class="line"><span class="comment">      | The ChuckHill2 base trace listener class handles 99% of the work.</span></div>
<div class="line"><span class="comment">      | ChuckHill2 Listeners are derived from this class:</span></div>
<div class="line"><span class="comment">      | (1) Handle custom message formatting.</span></div>
<div class="line"><span class="comment">      | (2) Handle redirection of Trace/Debug messages that do not contain a traceSource (some do!) to the &quot;TRACE&quot; traceSource.</span></div>
<div class="line"><span class="comment">      | (3) Safely cleanup upon close/dispose.</span></div>
<div class="line"><span class="comment">      | (4) Efficiently re-use pre-existing trace sources. System.Diagnostics by default does not!</span></div>
<div class="line"><span class="comment">      | (5) Thread-safe.</span></div>
<div class="line"><span class="comment">      | (6) Listeners are initialized only upon the first log message/event.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | The app.config listener attribute &#39;initializeData&#39;, contains a stringized, case-insensitive, dictionary of name/value (delimited by &#39;=&#39;) pairs delimited by &#39;;&#39;</span></div>
<div class="line"><span class="comment">      | These dictionary keys and default values are listed below:</span></div>
<div class="line"><span class="comment">      |  • SqueezeMsg=false - squeeze multi-line FullMessage and duplicate whitespace into a single line.</span></div>
<div class="line"><span class="comment">      |  • Async=true - lazily write messages to output destination. False may incur performance penalties as messages are written immediately.</span></div>
<div class="line"><span class="comment">      |  • IndentSize=Trace.IndentSize (typically 4) - How many spaces to indent succeeding lines in a multi-line FullMessage.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      |  • Format=(default determined by derived class) - same as interpolated format string.</span></div>
<div class="line"><span class="comment">      |    Possible &#39;Format&#39; argument values are (case-insensitive):</span></div>
<div class="line"><span class="comment">      |       Guid ActivityId - Gets the correlation activity id.</span></div>
<div class="line"><span class="comment">      |       String CallStack - Gets the call stack at the point of this event.</span></div>
<div class="line"><span class="comment">      |       DateTime DateTime - Gets the UTC datetime this event was posted. Use the datetime string formatting specifiers to get the format exactly as you want it.</span></div>
<div class="line"><span class="comment">      |       String DomainName - Gets the AppDomain friendly name for this event.</span></div>
<div class="line"><span class="comment">      |       String EntryAssemblyName - Gets the assembly name for this event.</span></div>
<div class="line"><span class="comment">      |       String Exception - Gets the current exception or empty if there is no exception.</span></div>
<div class="line"><span class="comment">      |       String ExceptionMessage - Gets the message part of exception or empty if there is no exception.</span></div>
<div class="line"><span class="comment">      |       String ExceptionOrCallStack -  Get the call stack or exception (if it exists) for Verbose log messages only. Returns empty if not verbose.</span></div>
<div class="line"><span class="comment">      |       DateTime LocalDateTime - Gets the local datetime this event was posted. Use the datetime string formatting specifiers to get the format exactly as you want it.</span></div>
<div class="line"><span class="comment">      |       String LogicalOperationStack - Gets the entire correlated logical call stack form the call context.</span></div>
<div class="line"><span class="comment">      |       Int32 ProcessId - Gets the unique identiier of the current process (PID)</span></div>
<div class="line"><span class="comment">      |       String ProcessName - Gets the name of this process.</span></div>
<div class="line"><span class="comment">      |       TraceEventType Severity - Gets the severity level for this log event.</span></div>
<div class="line"><span class="comment">      |       String SeverityString - Gets the severity level for this log event.</span></div>
<div class="line"><span class="comment">      |       UInt16 SourceId - Gets the integer source ID</span></div>
<div class="line"><span class="comment">      |       String SourceName - Gets the source name.</span></div>
<div class="line"><span class="comment">      |       Int32 ThreadId - Gets the current managed thread ID.</span></div>
<div class="line"><span class="comment">      |       String ThreadName -  Gets the current thread name or &#39;Thread &#39; + ThreadId if no thread name has been assigned.</span></div>
<div class="line"><span class="comment">      |       Int64 Timestamp - Gets the current number of ticks in the timer mechanism.</span></div>
<div class="line"><span class="comment">      |       String UserData - Custom data provided by the user. Object must have overridden ToString() else the string output will be just the class name.</span></div>
<div class="line"><span class="comment">      |       String UserMessage - The formatted user log message for this event.</span></div>
<div class="line"><span class="comment">      |       String Version - Gets the version of the assembly that called this event.</span></div>
<div class="line"><span class="comment">      |       String RequestBrowserType - Gets the name and major (integer) version number of the browser.</span></div>
<div class="line"><span class="comment">      |       String RequestData - Data associated with the Get or Post request.</span></div>
<div class="line"><span class="comment">      |       String RequestHttpMethod - Gets the HTTP data transfer method (such as GET, POST, or HEAD) used by the client.</span></div>
<div class="line"><span class="comment">      |       String RequestUrl - Gets the request Url.</span></div>
<div class="line"><span class="comment">      |       String RequestUrlLocalPath - Gets the request url local file name.</span></div>
<div class="line"><span class="comment">      |       String RequestUserAgent - Gets the raw user agent string of the client browser.</span></div>
<div class="line"><span class="comment">      |       String UserHostAddress - Gets IP address of remote client.</span></div>
<div class="line"><span class="comment">      |       String UserName - Gets the current user name associated with this HttpContext.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      |    App.Config &#39;Format&#39; example:</span></div>
<div class="line"><span class="comment">      |    FORMAT={LocalDateTime:yyyy-MM-ddTHH:mm:ss.fff} Severity: {Severity}, Source: {SourceName}\r\nMessage: {UserMessage}\r\n{ExceptionMessage}</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | Note: trace source &#39;traceOutputOptions&#39; attribute is ignored as the initializeData &#39;Format&#39; property handles this much better.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | Additional dictionary items are handled by the derived class.</span></div>
<div class="line"><span class="comment">      --&gt;</span></div>
<div class="line">      </div>
<div class="line">      <span class="comment">&lt;!-- EventLogTraceListener</span></div>
<div class="line"><span class="comment">      | Write log messages to the Windows Event Log.</span></div>
<div class="line"><span class="comment">      | Creates Event log and/or source if it does not already exist.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | Additional initializeData dictionary name/value pairs:</span></div>
<div class="line"><span class="comment">      |  • Machine=&quot;.&quot; - computer whos event log to write to. Requires write access.</span></div>
<div class="line"><span class="comment">      |  • Log=&quot;Application&quot; - EventLog log to write to.</span></div>
<div class="line"><span class="comment">      |  • Source=(no default). EventLog source to write to. If undefined EventLog logging disabled.</span></div>
<div class="line"><span class="comment">      | If &#39;Format&#39; is undefined, the default is: </span></div>
<div class="line"><span class="comment">      |    &quot;Category: {SourceName}\r\n{UserMessage}{Exception}&quot;</span></div>
<div class="line"><span class="comment">      --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;EventLogListener&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.Logging.EventLogTraceListener, ChuckHill2.Utilities&quot;</span> <span class="keyword">initializeData</span>=<span class="stringliteral">&quot;Source=LoggerDemo&quot;</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!--Optional MultiSourceFilter initializeData attribute contains a comma-delimited list of sources (case-insensitive) to ignore --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">filter</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.MultiSourceFilter, ChuckHill2.Utilities&quot;</span> <span class="keyword">initializeData</span>=<span class="stringliteral">&quot;DisallowedSource1,DisallowedSource2,DisallowedSource3&quot;</span> /&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">add</span>&gt;</div>
<div class="line">      </div>
<div class="line">      <span class="comment">&lt;!-- DebugTraceListener</span></div>
<div class="line"><span class="comment">      | Write log messages to the debugger output.</span></div>
<div class="line"><span class="comment">      | Output is available to an external debug viewer such as Microsoft&#39;s Dbgview.exe or</span></div>
<div class="line"><span class="comment">      | the VisualStudio debugger output window, but not both.</span></div>
<div class="line"><span class="comment">      | See: https://technet.microsoft.com/en-us/sysinternals/bb896647</span></div>
<div class="line"><span class="comment">      | There are no additional &#39;initializeData&#39; properties for this class.</span></div>
<div class="line"><span class="comment">      | If &#39;Format&#39; is undefined, the default is:</span></div>
<div class="line"><span class="comment">      |   &quot;Debug: {LocalDateTime:yyyy/MM/dd HH:mm:ss.fff} : {Severity} : {SourceName} : {UserMessage}&quot;</span></div>
<div class="line"><span class="comment">      --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DebugListener&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.Logging.DebugTraceListener, ChuckHill2.Utilities&quot;</span> /&gt;</div>
<div class="line">      </div>
<div class="line">      <span class="comment">&lt;!-- FileTraceListener</span></div>
<div class="line"><span class="comment">      | Write log messages to the specified file.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | Additional initializeData dictionary name/value pairs:</span></div>
<div class="line"><span class="comment">      |  • Filename - If undefined this is the same as the executable name with a &quot;.log&quot; extension. </span></div>
<div class="line"><span class="comment">      |    This may be a Relative or full filepath (may or may not exist) which may</span></div>
<div class="line"><span class="comment">      |    contain any environment variables including pseudo-environment variables: </span></div>
<div class="line"><span class="comment">      |     - ProcessName,</span></div>
<div class="line"><span class="comment">      |     - ProcessId(as 4 hex digits), </span></div>
<div class="line"><span class="comment">      |     - AppDomainName, and </span></div>
<div class="line"><span class="comment">      |     - BaseDir.</span></div>
<div class="line"><span class="comment">      |  • MaxSize=100 (MB) - max file size before starting over with a new file.</span></div>
<div class="line"><span class="comment">      |  • MaxFiles=-1 (infinite) - Maximum number of log files before deleting the oldest.</span></div>
<div class="line"><span class="comment">      |  • FileHeader=(no default) - String literal to insert as the first line(s) in a new file.</span></div>
<div class="line"><span class="comment">      |  • FileFooter=(no default) - String literal to append as the last line(s) in a file being closed.</span></div>
<div class="line"><span class="comment">      | If &#39;Format&#39; is undefined, the default is: &quot;{LocalDateTime:yyyy-MM-dd HH:mm:ss.fff},{Severity},{SourceName},&quot;{UserMessage}&quot;</span></div>
<div class="line"><span class="comment">      | and FileHeader=&quot;DateTime,Severity,SourceName,Message&quot;</span></div>
<div class="line"><span class="comment">      --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;CsvFileListener&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.Logging.FileTraceListener, ChuckHill2.Utilities&quot;</span> /&gt;</div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FormattedFileListener&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.Logging.FileTraceListener, ChuckHill2.Utilities&quot;</span></div>
<div class="line">           <span class="keyword">initializeData</span>=<span class="stringliteral">&quot;Filename=%ProcessName%-%ProcessId%.log;</span></div>
<div class="line"><span class="stringliteral">           Format={LocalDateTime:yyyy-MM-ddTHH:mm:ss.fff} Severity: {Severity}, Source: {SourceName}\r\nMessage: {UserMessage}\r\n{ExceptionOrCallStack}&quot;</span> /&gt;</div>
<div class="line">        </div>
<div class="line">      <span class="comment">&lt;!-- EmailTraceListener</span></div>
<div class="line"><span class="comment">      | Write log messages as email messages to the mail server.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | Additional initializeData dictionary name/value pairs:</span></div>
<div class="line"><span class="comment">      |  • Subject=&quot;Log: {SourceName}&quot; - email subject line.</span></div>
<div class="line"><span class="comment">      |  • SendTo=(no default) - comma-delimited list of email addresses to send to. Whitespace is ignored.</span></div>
<div class="line"><span class="comment">      |    Addresses may be in the form of &quot;username@domain.com&quot; or &quot;UserName &amp;amp;lt;username@domain.com&amp;amp;gt;&quot;. </span></div>
<div class="line"><span class="comment">      |    If undefined, email logging is disabled.</span></div>
<div class="line"><span class="comment">      |       </span></div>
<div class="line"><span class="comment">      | The following are explicitly defined here or defaulted from app.config configuration/system.net/mailSettings/smtp;</span></div>
<div class="line"><span class="comment">      |  • SentFrom=system.net/mailSettings/smtp/@from - the &#39;from&#39; email address. Whitespace is ignored. Addresses may be in the form of &quot;username@domain.com&quot; or &quot;UserName &amp;amp;lt;username@domain.com&amp;amp;gt;&quot;.</span></div>
<div class="line"><span class="comment">      |  • ClientDomain=LocalHost - aka &quot;www.gmail.com&quot;</span></div>
<div class="line"><span class="comment">      |  • DefaultCredentials=true - true to use windows authentication, false to use UserName and Password.</span></div>
<div class="line"><span class="comment">      |  • UserName=(no default)</span></div>
<div class="line"><span class="comment">      |  • Password=(no default)</span></div>
<div class="line"><span class="comment">      |  • EnableSsl=false -</span></div>
<div class="line"><span class="comment">      |  • MailServer=(no default) - aka &quot;smtp.gmail.com&quot;</span></div>
<div class="line"><span class="comment">      |  • Port=25 - mail server listener port to send messages to.</span></div>
<div class="line"><span class="comment">      |</span></div>
<div class="line"><span class="comment">      | If &#39;Format&#39; is undefined, the default is:</span></div>
<div class="line"><span class="comment">      |   &quot;DateTime : {LocalDateTime:yyyy/MM/dd HH:mm:ss.fff}\r\nSeverity : {Severity}\r\nSource   : {SourceName}\r\nMessage  : {UserMessage}&quot;</span></div>
<div class="line"><span class="comment">      --&gt;</span></div>
<div class="line">      &lt;<span class="keywordtype">add</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;EmailListener&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ChuckHill2.Logging.EmailTraceListener, ChuckHill2.Utilities&quot;</span> <span class="keyword">initializeData</span>=&quot;</div>
<div class="line">           <span class="keyword">SentFrom</span>=<span class="keyword">System</span> <span class="keyword">Admin</span> &amp;<span class="keyword">amp</span>;<span class="keyword">lt</span>;<span class="keyword">charlesh</span>@<span class="keyword">mycompany.com</span>&amp;<span class="keyword">amp</span>;<span class="keyword">gt</span>;;</div>
<div class="line">           <span class="keyword">SendTo</span>=<span class="keyword">ChuckHill2</span> &amp;<span class="keyword">amp</span>;<span class="keyword">lt</span>;<span class="keyword">chuckhill2</span>@<span class="keyword">gmail.com</span>&amp;<span class="keyword">amp</span>;<span class="keyword">gt</span>;<span class="stringliteral">&quot; /&gt;</span></div>
<div class="line"><span class="stringliteral">           </span></div>
<div class="line"><span class="stringliteral">      &lt;!-- DatabaseListener</span></div>
<div class="line"><span class="stringliteral">      | Write log messages to database table.</span></div>
<div class="line"><span class="stringliteral">      |</span></div>
<div class="line"><span class="stringliteral">      | Additional initializeData dictionary name/value pairs:</span></div>
<div class="line"><span class="stringliteral">      |  • ConnectionString=(no default) - a string key representing AppConfig ConfigurationManager.ConnectionStrings[] dictionary entry OR literal full SQL connection string.</span></div>
<div class="line"><span class="stringliteral">      |  • SqlStatement=(no default) - SQL statement to insert logging values into the database table.</span></div>
<div class="line"><span class="stringliteral">      |    Examples:</span></div>
<div class="line"><span class="stringliteral">      |      &quot;</span><span class="keyword">spStoredProcedure</span> @<span class="keyword">LocalDateTime</span>, @<span class="keyword">Severity</span>, @<span class="keyword">SourceName</span>, @<span class="keyword">UserMessage</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">      |      &quot;</span><span class="keyword">spStoredProcedure</span> @<span class="keyword">Date</span>=@<span class="keyword">LocalDateTime</span>, @<span class="keyword">Severity</span>=@<span class="keyword">Severity</span>, @<span class="keyword">Source</span>=@<span class="keyword">SourceName</span>, @<span class="keyword">Message</span>=@<span class="keyword">UserMessage</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">      |      &quot;</span><span class="keyword">spStoredProcedure</span> @<span class="keyword">Date</span>={0}, @<span class="keyword">Severity</span>={1}, @<span class="keyword">Source</span>={2}, @<span class="keyword">Message</span>={3}<span class="stringliteral">&quot;, LocalDateTime, Severity, SourceName,@UserMessage</span></div>
<div class="line"><span class="stringliteral">      |      &quot;</span><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">MyTable</span> ([<span class="keyword">Date</span>],<span class="keyword">Severity</span>,<span class="keyword">Source</span>,<span class="keyword">Message</span>) <span class="keyword">VALUES</span> (@<span class="keyword">LocalDateTime</span>, @<span class="keyword">Severity</span>, @<span class="keyword">SourceName</span>, @<span class="keyword">UserMessage</span>)<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">      |      &quot;</span><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">MyTable</span> ([<span class="keyword">Date</span>],<span class="keyword">Severity</span>,<span class="keyword">Source</span>,<span class="keyword">Message</span>) <span class="keyword">VALUES</span> ({0}, {1}, {2}, {3})<span class="stringliteral">&quot;, LocalDateTime, Severity, SourceName, UserMessage</span></div>
<div class="line"><span class="stringliteral">      | The &#39;Format&#39; and &#39;IndentSize&#39; properties are not used.</span></div>
<div class="line"><span class="stringliteral">      --&gt;</span></div>
<div class="line"><span class="stringliteral">      &lt;add name=&quot;</span><span class="keyword">DbListener</span><span class="stringliteral">&quot; type=&quot;</span><span class="keyword">ChuckHill2.Logging.DatabaseListener</span>, <span class="keyword">ChuckHill2.Utilities</span><span class="stringliteral">&quot; initializeData=&quot;</span></div>
<div class="line">           <span class="keyword">ConnectionString</span>=<span class="keyword">Data</span> <span class="keyword">Source</span>=(<span class="keyword">local</span>)\;<span class="keyword">Initial</span> <span class="keyword">Catalog</span>=<span class="keyword">VIA</span>\<span class="keyword">_Security</span>\;<span class="keyword">Integrated</span> <span class="keyword">Security</span>=<span class="keyword">SSPI</span>;</div>
<div class="line">           <span class="keyword">SqlStatement</span>=<span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">MyTable</span> ([<span class="keyword">Date</span>],<span class="keyword">Severity</span>,<span class="keyword">Source</span>,<span class="keyword">Message</span>) <span class="keyword">VALUES</span> (@<span class="keyword">LocalDateTime</span>, @<span class="keyword">SeverityString</span>, @<span class="keyword">SourceName</span>, @<span class="keyword">UserMessage</span>)<span class="stringliteral">&quot;/&gt;</span></div>
<div class="line"><span class="stringliteral">           </span></div>
<div class="line"><span class="stringliteral">    &lt;/sharedListeners&gt;</span></div>
<div class="line"><span class="stringliteral">  &lt;/system.diagnostics&gt;</span></div>
<div class="line"><span class="stringliteral">  &lt;system.net&gt;</span></div>
<div class="line"><span class="stringliteral">    &lt;mailSettings&gt;</span></div>
<div class="line"><span class="stringliteral">      &lt;!-- Alternate settings</span></div>
<div class="line"><span class="stringliteral">      &lt;smtp deliveryMethod=&quot;</span><span class="keyword">Network</span><span class="stringliteral">&quot; from=&quot;</span><span class="keyword">Logger</span> &amp;<span class="keyword">amp</span>;<span class="keyword">lt</span>;<span class="keyword">myName</span>@<span class="keyword">mycompany.com</span>&amp;<span class="keyword">amp</span>;<span class="keyword">gt</span>;<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">        &lt;network</span></div>
<div class="line"><span class="stringliteral">          clientDomain=&quot;</span><span class="keyword">www.mycompany.com</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          defaultCredentials=&quot;</span><span class="keyword">true</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          userName=&quot;</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          password=&quot;</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          enableSsl=&quot;</span><span class="keyword">false</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          host=&quot;</span><span class="keyword">smtp.mycompany.com</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          port=&quot;</span>25<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">        /&gt;</span></div>
<div class="line"><span class="stringliteral">      &lt;/smtp&gt;</span></div>
<div class="line"><span class="stringliteral">       --&gt;</span></div>
<div class="line"><span class="stringliteral">      &lt;smtp deliveryMethod=&quot;</span><span class="keyword">Network</span><span class="stringliteral">&quot; from=&quot;</span><span class="keyword">Logger</span> &amp;<span class="keyword">amp</span>;<span class="keyword">lt</span>;<span class="keyword">myName</span>@<span class="keyword">mycompany.com</span>&amp;<span class="keyword">amp</span>;<span class="keyword">gt</span>;<span class="stringliteral">&quot;&gt;</span></div>
<div class="line"><span class="stringliteral">        &lt;network</span></div>
<div class="line"><span class="stringliteral">          defaultCredentials=&quot;</span><span class="keyword">false</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          userName=&quot;</span><span class="keyword">myName</span>@<span class="keyword">gmail.com</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          password=&quot;</span><span class="keyword">myPassword</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          enableSsl=&quot;</span><span class="keyword">true</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          host=&quot;</span><span class="keyword">smtp.gmail.com</span><span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">          port=&quot;</span>587<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">        /&gt;</span></div>
<div class="line"><span class="stringliteral">      &lt;/smtp&gt;</span></div>
<div class="line"><span class="stringliteral">    &lt;/mailSettings&gt;</span></div>
<div class="line"><span class="stringliteral">  &lt;/system.net&gt;</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">  &lt;startup&gt;</span></div>
<div class="line"><span class="stringliteral">    &lt;supportedRuntime version=&quot;</span><span class="keyword">v4.0</span><span class="stringliteral">&quot; sku=&quot;</span>.<span class="keyword">NETFramework</span>,<span class="keyword">Version</span>=<span class="keyword">v4.5</span>&quot; /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">startup</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">configuration</span>&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
