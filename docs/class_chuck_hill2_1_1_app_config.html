<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChuckHill2.Utilities: ChuckHill2.AppConfig Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxygen_Extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ProjectLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChuckHill2.Utilities
   &#160;<span id="projectnumber">1.0.1.0</span>
   </div>
   <div id="projectbrief">C# WinForms Utility Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_chuck_hill2.html">ChuckHill2</a></li><li class="navelem"><a class="el" href="class_chuck_hill2_1_1_app_config.html">AppConfig</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="class_chuck_hill2_1_1_app_config-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ChuckHill2.AppConfig Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Use an alternate application configuration file. Similar to:  
 <a href="class_chuck_hill2_1_1_app_config.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for ChuckHill2.AppConfig:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_chuck_hill2_1_1_app_config.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3e9e75527b448e114d9a3578b1293c74"><td class="memItemLeft" align="right" valign="top">abstract void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#a3e9e75527b448e114d9a3578b1293c74">Dispose</a> ()</td></tr>
<tr class="memdesc:a3e9e75527b448e114d9a3578b1293c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores original app config to this instance object.  <a href="class_chuck_hill2_1_1_app_config.html#a3e9e75527b448e114d9a3578b1293c74">More...</a><br /></td></tr>
<tr class="separator:a3e9e75527b448e114d9a3578b1293c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab5a3dc2901bf41516f97f1576db747b1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_chuck_hill2_1_1_app_config.html">AppConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#ab5a3dc2901bf41516f97f1576db747b1">Change</a> (string path, bool sysDiagChanged=false)</td></tr>
<tr class="memdesc:ab5a3dc2901bf41516f97f1576db747b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change App config to filename specified.  <a href="class_chuck_hill2_1_1_app_config.html#ab5a3dc2901bf41516f97f1576db747b1">More...</a><br /></td></tr>
<tr class="separator:ab5a3dc2901bf41516f97f1576db747b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cec5fe57ace0b4e70a321bcdcdf202e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#a6cec5fe57ace0b4e70a321bcdcdf202e">RefreshConfig</a> ()</td></tr>
<tr class="memdesc:a6cec5fe57ace0b4e70a321bcdcdf202e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force refresh entire Application/Web Config, in-place.  <a href="class_chuck_hill2_1_1_app_config.html#a6cec5fe57ace0b4e70a321bcdcdf202e">More...</a><br /></td></tr>
<tr class="separator:a6cec5fe57ace0b4e70a321bcdcdf202e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e7536c8d9b7be47dc94d2ac63b89bb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_chuck_hill2_1_1_app_config.html">AppConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#a12e7536c8d9b7be47dc94d2ac63b89bb">SetConfigValue</a> (string xpath, string value)</td></tr>
<tr class="memdesc:a12e7536c8d9b7be47dc94d2ac63b89bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify a single preexisting Web config or App config value.  <a href="class_chuck_hill2_1_1_app_config.html#a12e7536c8d9b7be47dc94d2ac63b89bb">More...</a><br /></td></tr>
<tr class="separator:a12e7536c8d9b7be47dc94d2ac63b89bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:adc93bb778369324d365439cf6e97bec1"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#adc93bb778369324d365439cf6e97bec1">CurrentPath</a><code> [get]</code></td></tr>
<tr class="memdesc:adc93bb778369324d365439cf6e97bec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current app config filename.  <a href="class_chuck_hill2_1_1_app_config.html#adc93bb778369324d365439cf6e97bec1">More...</a><br /></td></tr>
<tr class="separator:adc93bb778369324d365439cf6e97bec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6081b86ba67f617fca16eb675fe07ac"><td class="memItemLeft" align="right" valign="top">abstract bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#ac6081b86ba67f617fca16eb675fe07ac">IsDisposed</a><code> [get]</code></td></tr>
<tr class="memdesc:ac6081b86ba67f617fca16eb675fe07ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if this appconfig instance is disposed/restored.  <a href="class_chuck_hill2_1_1_app_config.html#ac6081b86ba67f617fca16eb675fe07ac">More...</a><br /></td></tr>
<tr class="separator:ac6081b86ba67f617fca16eb675fe07ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17b3d8b95e050041fee19a49b3dfa001"><td class="memItemLeft" align="right" valign="top">abstract string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_app_config.html#a17b3d8b95e050041fee19a49b3dfa001">Path</a><code> [get]</code></td></tr>
<tr class="memdesc:a17b3d8b95e050041fee19a49b3dfa001"><td class="mdescLeft">&#160;</td><td class="mdescRight">App config filename associated with this app config instance object.  <a href="class_chuck_hill2_1_1_app_config.html#a17b3d8b95e050041fee19a49b3dfa001">More...</a><br /></td></tr>
<tr class="separator:a17b3d8b95e050041fee19a49b3dfa001"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Use an alternate application configuration file. Similar to: </p>
<div class="fragment"><div class="line">Configuration config = ConfigurationManager.OpenExeConfiguration(exePath);</div>
</div><!-- fragment --><p> <em>Except</em> it becomes the default application configuration for the entire application until it is Disposed().<br  />
 Use <a class="el" href="class_chuck_hill2_1_1_app_config.html#a3e9e75527b448e114d9a3578b1293c74" title="Restores original app config to this instance object.">Dispose()</a> to restore the original application configuration file.<br  />
 Useful when child assemblies also reference the static System.Configuration.ConfigurationManager class.<br  />
 This is not a merge. It is an entire replacement. Any in-memory changes to ConfigurationManager will be lost.</p>
<p>https://stackoverflow.com/questions/6150644/change-default-app-config-at-runtime </p><dl class="section see"><dt>See also</dt><dd>https://stackoverflow.com/questions/480538/use-xml-includes-or-config-references-in-app-config-to-include-other-config-file</dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab5a3dc2901bf41516f97f1576db747b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a3dc2901bf41516f97f1576db747b1">&#9670;&nbsp;</a></span>Change()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_chuck_hill2_1_1_app_config.html">AppConfig</a> ChuckHill2.AppConfig.Change </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sysDiagChanged</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Change App config to filename specified. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Full or relative path to app config file. If file does not end with ".config", it will be appended. If the app config is already being used, null is returned and the config is not changed. </td></tr>
    <tr><td class="paramname">sysDiagChanged</td><td>True if anything changed in the system.diagnostics node. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Previous app config object or NULL if app config already in use Call <a class="el" href="class_chuck_hill2_1_1_app_config.html#a3e9e75527b448e114d9a3578b1293c74" title="Restores original app config to this instance object.">Dispose()</a> to restore previous app config. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">System.ArgumentException</td><td>path is a zero-length string, contains only white space, or contains one or more of the invalid characters defined in System.IO.Path.GetInvalidPathChars(). -or- The system could not retrieve the absolute path. </td></tr>
    <tr><td class="paramname">System.Security.SecurityException</td><td>The caller does not have the required permissions. </td></tr>
    <tr><td class="paramname">System.ArgumentNullException</td><td>path is null. </td></tr>
    <tr><td class="paramname">System.NotSupportedException</td><td>path contains a colon (":") that is not part of a volume identifier (for example, "c:\"). </td></tr>
    <tr><td class="paramname">System.IO.PathTooLongException</td><td>The specified path, file name, or both exceed the system-defined maximum length. For example, on Windows-based platforms, paths must be less than 248 characters, and file names must be less than 260 characters. </td></tr>
    <tr><td class="paramname">System.IO.FileNotFoundException</td><td>The app config file is not found. </td></tr>
    <tr><td class="paramname">System.UnauthorizedAccessException</td><td>path is read-only or is a directory. </td></tr>
    <tr><td class="paramname">System.IO.DirectoryNotFoundException</td><td>The specified path is invalid, such as being on an unmapped drive. </td></tr>
    <tr><td class="paramname">System.IO.IOException</td><td>The file is already open. </td></tr>
    <tr><td class="paramname">System.Configuration.ConfigurationErrorsException</td><td>A configuration file could not be loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3e9e75527b448e114d9a3578b1293c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9e75527b448e114d9a3578b1293c74">&#9670;&nbsp;</a></span>Dispose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">abstract void ChuckHill2.AppConfig.Dispose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restores original app config to this instance object. </p>

</div>
</div>
<a id="a6cec5fe57ace0b4e70a321bcdcdf202e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cec5fe57ace0b4e70a321bcdcdf202e">&#9670;&nbsp;</a></span>RefreshConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ChuckHill2.AppConfig.RefreshConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Force refresh entire Application/Web Config, in-place. </p>

</div>
</div>
<a id="a12e7536c8d9b7be47dc94d2ac63b89bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12e7536c8d9b7be47dc94d2ac63b89bb">&#9670;&nbsp;</a></span>SetConfigValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_chuck_hill2_1_1_app_config.html">AppConfig</a> ChuckHill2.AppConfig.SetConfigValue </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>xpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modify a single preexisting Web config or App config value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xpath</td><td>Full xPath to value to change</td></tr>
    <tr><td class="paramname">value</td><td>string value to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new <a class="el" href="class_chuck_hill2_1_1_app_config.html" title="Use an alternate application configuration file. Similar to:">AppConfig</a> object. Dispose to revert. Will throw exception upon failure.</dd></dl>
<p>This creates a temporary copy of the current app.config with a random name in the TEMP directory, modifies the value as <a class="el" href="class_chuck_hill2_1_1_xml.html" title="XML Management Utilities">Xml</a> and loads the new app.config. If the purpose is to decrypt an encrypted value, THIS IS NOT SECURE. See <a class="el" href="class_chuck_hill2_1_1_encryption.html#a4e83d8abce5f41ea55236b6355d705d5" title="Decrypt, cleanup, and fixup the ConfigurationManager values as necessary BEFORE anyone,...">Encryption.DecryptConfigurationManagerConnectionString(string key)</a> for a secure in-memory example. </p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="adc93bb778369324d365439cf6e97bec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc93bb778369324d365439cf6e97bec1">&#9670;&nbsp;</a></span>CurrentPath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string ChuckHill2.AppConfig.CurrentPath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current app config filename. </p>

</div>
</div>
<a id="ac6081b86ba67f617fca16eb675fe07ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6081b86ba67f617fca16eb675fe07ac">&#9670;&nbsp;</a></span>IsDisposed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">abstract bool ChuckHill2.AppConfig.IsDisposed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if this appconfig instance is disposed/restored. </p>

</div>
</div>
<a id="a17b3d8b95e050041fee19a49b3dfa001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17b3d8b95e050041fee19a49b3dfa001">&#9670;&nbsp;</a></span>Path</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">abstract string ChuckHill2.AppConfig.Path</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>App config filename associated with this app config instance object. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>AppConfig.cs</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
