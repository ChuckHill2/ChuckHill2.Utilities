<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChuckHill2.Utilities: ChuckHill2.FileEx Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxygen_Extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ProjectLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChuckHill2.Utilities
   &#160;<span id="projectnumber">1.0.1.0</span>
   </div>
   <div id="projectbrief">C# WinForms Utility Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_chuck_hill2.html">ChuckHill2</a></li><li class="navelem"><a class="el" href="class_chuck_hill2_1_1_file_ex.html">FileEx</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#events">Events</a> &#124;
<a href="class_chuck_hill2_1_1_file_ex-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ChuckHill2.FileEx Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>File Downloader  
 <a href="class_chuck_hill2_1_1_file_ex.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex_1_1_job.html">Job</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Info to pass to FileEx.Downloader.  <a href="class_chuck_hill2_1_1_file_ex_1_1_job.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ae2208862dbc406035ad9ce030ecf6606"><td class="memItemLeft" align="right" valign="top"><a id="ae2208862dbc406035ad9ce030ecf6606"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>DownloadState</b> { <br />
&#160;&#160;<b>Success</b>, 
<b>EmptyFile</b>, 
<b>ThreadAbort</b>, 
<b>DiskFull</b>, 
<br />
&#160;&#160;<b>NotFound</b>, 
<b>NetworkConnectionFailure</b>
<br />
 }</td></tr>
<tr class="separator:ae2208862dbc406035ad9ce030ecf6606"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a76da876864f0214150f66b26e263e89a"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a76da876864f0214150f66b26e263e89a">GetUrlExtension</a> (string url)</td></tr>
<tr class="memdesc:a76da876864f0214150f66b26e263e89a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get file extension (with leading '.') from url. If none found, assumes ".htm"  <a href="class_chuck_hill2_1_1_file_ex.html#a76da876864f0214150f66b26e263e89a">More...</a><br /></td></tr>
<tr class="separator:a76da876864f0214150f66b26e263e89a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4044339e1d7829a19186ad0bdc6a248c"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a4044339e1d7829a19186ad0bdc6a248c">GetUrlFileNameWithoutExtension</a> (string url)</td></tr>
<tr class="memdesc:a4044339e1d7829a19186ad0bdc6a248c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get filename part (no extension) from url.  <a href="class_chuck_hill2_1_1_file_ex.html#a4044339e1d7829a19186ad0bdc6a248c">More...</a><br /></td></tr>
<tr class="separator:a4044339e1d7829a19186ad0bdc6a248c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a010fa495322afbdb2eb066b3ffa336f7"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a010fa495322afbdb2eb066b3ffa336f7">GetAbsoluteUrl</a> (string baseUrl, string relativeUrl)</td></tr>
<tr class="memdesc:a010fa495322afbdb2eb066b3ffa336f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make absolute url from baseUrl + relativeUrl. If relativeUrl contains an absolute Url, returns that url unmodified. If any errors occur during combination of the two parts, string.Empty is returned.  <a href="class_chuck_hill2_1_1_file_ex.html#a010fa495322afbdb2eb066b3ffa336f7">More...</a><br /></td></tr>
<tr class="separator:a010fa495322afbdb2eb066b3ffa336f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f370a8064d396c5c0b7d2dedd76249b"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a1f370a8064d396c5c0b7d2dedd76249b">MakeUrlReferer</a> (string url)</td></tr>
<tr class="memdesc:a1f370a8064d396c5c0b7d2dedd76249b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an HTML referrer from a URL.  <a href="class_chuck_hill2_1_1_file_ex.html#a1f370a8064d396c5c0b7d2dedd76249b">More...</a><br /></td></tr>
<tr class="separator:a1f370a8064d396c5c0b7d2dedd76249b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247dc9c430f23b043931ba9765231cf3"><td class="memItemLeft" align="right" valign="top">static DateTime&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a247dc9c430f23b043931ba9765231cf3">GetCreationDate</a> (string filename)</td></tr>
<tr class="memdesc:a247dc9c430f23b043931ba9765231cf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get earliest file or directory datetime. Empirically, it appears that the LastAccess or LastWrite times can be earlier than the Creation time! For consistency, this method just returns the earliest of these three file datetimes.  <a href="class_chuck_hill2_1_1_file_ex.html#a247dc9c430f23b043931ba9765231cf3">More...</a><br /></td></tr>
<tr class="separator:a247dc9c430f23b043931ba9765231cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62807c3046ab8e25d0adfb86742a5725"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a62807c3046ab8e25d0adfb86742a5725">ReadHtml</a> (string filename, bool noScript=false)</td></tr>
<tr class="memdesc:a62807c3046ab8e25d0adfb86742a5725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get html file content as string without unecessary whitespace, no newlines and replace all double-quotes with single-quotes. Sometimes html quoting is done with single-quotes and sometimes with double-quotes. These fixups are all legal html and also make it easier to parse with Regex. This is still valid html readable by a browser.  <a href="class_chuck_hill2_1_1_file_ex.html#a62807c3046ab8e25d0adfb86742a5725">More...</a><br /></td></tr>
<tr class="separator:a62807c3046ab8e25d0adfb86742a5725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b5913955caf69c841bfa2f13f3e9fe"><td class="memItemLeft" align="right" valign="top">static DownloadState&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#ae9b5913955caf69c841bfa2f13f3e9fe">Download</a> (<a class="el" href="class_chuck_hill2_1_1_file_ex_1_1_job.html">Job</a> data)</td></tr>
<tr class="memdesc:ae9b5913955caf69c841bfa2f13f3e9fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Download a URL item into a local file. Due to network or server glitches or delays, this will try 3 times before giving up. Will not throw an exception. Errors are written to Logger.  <a href="class_chuck_hill2_1_1_file_ex.html#ae9b5913955caf69c841bfa2f13f3e9fe">More...</a><br /></td></tr>
<tr class="separator:ae9b5913955caf69c841bfa2f13f3e9fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="events"></a>
Events</h2></td></tr>
<tr class="memitem:a2c83cf304318b3c5f68e801b7b4b413d"><td class="memItemLeft" align="right" valign="top">static Action&lt; TraceEventType, string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_chuck_hill2_1_1_file_ex.html#a2c83cf304318b3c5f68e801b7b4b413d">Logger</a></td></tr>
<tr class="memdesc:a2c83cf304318b3c5f68e801b7b4b413d"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined logger when errors occur in the <a class="el" href="class_chuck_hill2_1_1_file_ex.html#ae9b5913955caf69c841bfa2f13f3e9fe" title="Download a URL item into a local file. Due to network or server glitches or delays,...">Download()</a> method. If not set, messages go to the debugger output.  <a href="class_chuck_hill2_1_1_file_ex.html#a2c83cf304318b3c5f68e801b7b4b413d">More...</a><br /></td></tr>
<tr class="separator:a2c83cf304318b3c5f68e801b7b4b413d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File Downloader </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ae9b5913955caf69c841bfa2f13f3e9fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9b5913955caf69c841bfa2f13f3e9fe">&#9670;&nbsp;</a></span>Download()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DownloadState ChuckHill2.FileEx.Download </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_chuck_hill2_1_1_file_ex_1_1_job.html">Job</a>&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Download a URL item into a local file. Due to network or server glitches or delays, this will try 3 times before giving up. Will not throw an exception. Errors are written to Logger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td><a class="el" href="class_chuck_hill2_1_1_file_ex_1_1_job.html" title="Info to pass to FileEx.Downloader.">Job</a> to download (url and suggested destination filename)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successfully downloaded</dd></dl>

</div>
</div>
<a id="a010fa495322afbdb2eb066b3ffa336f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a010fa495322afbdb2eb066b3ffa336f7">&#9670;&nbsp;</a></span>GetAbsoluteUrl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string ChuckHill2.FileEx.GetAbsoluteUrl </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>baseUrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>relativeUrl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make absolute url from baseUrl + relativeUrl. If relativeUrl contains an absolute Url, returns that url unmodified. If any errors occur during combination of the two parts, string.Empty is returned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">baseUrl</td><td></td></tr>
    <tr><td class="paramname">relativeUrl</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>absolute Url</dd></dl>

</div>
</div>
<a id="a247dc9c430f23b043931ba9765231cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a247dc9c430f23b043931ba9765231cf3">&#9670;&nbsp;</a></span>GetCreationDate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DateTime ChuckHill2.FileEx.GetCreationDate </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get earliest file or directory datetime. Empirically, it appears that the LastAccess or LastWrite times can be earlier than the Creation time! For consistency, this method just returns the earliest of these three file datetimes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Full directory or filepath</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DateTime</dd></dl>

</div>
</div>
<a id="a76da876864f0214150f66b26e263e89a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76da876864f0214150f66b26e263e89a">&#9670;&nbsp;</a></span>GetUrlExtension()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string ChuckHill2.FileEx.GetUrlExtension </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get file extension (with leading '.') from url. If none found, assumes ".htm" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a4044339e1d7829a19186ad0bdc6a248c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4044339e1d7829a19186ad0bdc6a248c">&#9670;&nbsp;</a></span>GetUrlFileNameWithoutExtension()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string ChuckHill2.FileEx.GetUrlFileNameWithoutExtension </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get filename part (no extension) from url. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a1f370a8064d396c5c0b7d2dedd76249b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f370a8064d396c5c0b7d2dedd76249b">&#9670;&nbsp;</a></span>MakeUrlReferer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string ChuckHill2.FileEx.MakeUrlReferer </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create an HTML referrer from a URL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a62807c3046ab8e25d0adfb86742a5725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62807c3046ab8e25d0adfb86742a5725">&#9670;&nbsp;</a></span>ReadHtml()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string ChuckHill2.FileEx.ReadHtml </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>noScript</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get html file content as string without unecessary whitespace, no newlines and replace all double-quotes with single-quotes. Sometimes html quoting is done with single-quotes and sometimes with double-quotes. These fixups are all legal html and also make it easier to parse with Regex. This is still valid html readable by a browser. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>HTML filename to read.</td></tr>
    <tr><td class="paramname">noScript</td><td>True to remove everything between script, style, and svg tags.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Long single-line string without unecessary whitespace.</dd></dl>

</div>
</div>
<h2 class="groupheader">Event Documentation</h2>
<a id="a2c83cf304318b3c5f68e801b7b4b413d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c83cf304318b3c5f68e801b7b4b413d">&#9670;&nbsp;</a></span>Logger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Action&lt;TraceEventType, string&gt; ChuckHill2.FileEx.Logger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>User-defined logger when errors occur in the <a class="el" href="class_chuck_hill2_1_1_file_ex.html#ae9b5913955caf69c841bfa2f13f3e9fe" title="Download a URL item into a local file. Due to network or server glitches or delays,...">Download()</a> method. If not set, messages go to the debugger output. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>FileEx.cs</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
